#!/bin/zsh
#
# Add an alias to the current shell session and put it in ~/etc/aliases
# for use in the future.

name=$1
cmd=$2

if [[ -z $name && -z $cmd ]]; then
  echo "You must enter a name and command (name: $name, cmd: $cmd)"
  exit 1
fi

zparseopts -K -- r:=remove m:=message

if [ -n "${remove+x}" ]; then
  action='Remove'
else
  action='Add'
fi

if [[ -z $message ]]; then
  message="${action} alias ${name}"
fi

case "$action" in
  Add)
    line="alias ${name}='${cmd}'"
    echo "${line}" >> $HOME/etc/aliases.zsh
    homer_add $HOME/etc/aliases.zsh $message
    ;;
  Remove)
    sed "s/alias ${line}=.*$//" $HOME/etc/aliases.zsh > /tmp/aliases
    mv /tmp/aliases $HOME/aliases.zsh
    homer_add $HOME/etc/aliases.zsh $message
    ;;
esac
